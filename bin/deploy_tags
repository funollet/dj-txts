#!/bin/bash
# deploy_tags
#   Install TagsField application in a Django project directory.
#   Install CSS, JS and PNG files in MEDIA_ROOT.
#
# Jordi Funollet <jordi.f@ati.es>  Fri, 29 Dec 2006 17:19:41 +0100
#
# The script assumes it will be run from the project root directory
# and that the MEDIA_ROOT directory looks like this (or it will):
#    media/
#    |-- css
#    |-- img
#    |-- js
#    `-- tags


#### Customize if needed #######################################
DOWNL_URL='http://softwaremaniacs.org/media/soft/tags/tags.zip'
APPL_DIR='tags'     # Application will live here.
################################################################

MEDIA_ROOT="`pwd`/media"

if [ ! -f bin/tags.css.patch ] ; then
    echo "File not found: tags.css.patch."
    echo "Please put it on your project's root directory and try again."
    exit 1
fi

mkdir $APPL_DIR
cd $APPL_DIR
wget $DOWNL_URL     # Download.
unzip *.zip         # Extract.

# cleanup
rm *.txt *.html *.zip style/demo.css

# Put JavaScript files on your media directory.
if [ ! -d $MEDIA_ROOT/js ] ; then
    mkdir -p $MEDIA_ROOT/js
fi
mv js/* $MEDIA_ROOT/js/
rmdir js

# Tweak CSS to display better on Django's admin.
patch style/tags.css ../bin/tags.css.patch
# Put CSS files on your media directory.
if [ ! -d $MEDIA_ROOT/css ] ; then
    mkdir -p $MEDIA_ROOT/css
fi
mv style/tags.css $MEDIA_ROOT/css/

# Put graphic files on your media directory.
if [ ! -d $MEDIA_ROOT/tags ] ; then
    mkdir -p $MEDIA_ROOT/tags
fi
mv style/*png $MEDIA_ROOT/tags
rmdir style

# Informative message.
cat <<.
Deployment finished.
Remember to run './manage.py syncdb' after modifying your settings:
    INSTALLED_APPS = (..., 'yourproject.tags', )
    STYLE_URL = '/your/media/tags/'
.

